.\" Automatically generated by Pod::Man 2.22 (Pod::Simple 3.07)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is turned on, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.ie \nF \{\
.    de IX
.    tm Index:\\$1\t\\n%\t"\\$2"
..
.    nr % 0
.    rr F
.\}
.el \{\
.    de IX
..
.\}
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "Mail::Box 3"
.TH Mail::Box 3 "2014-08-24" "perl v5.10.1" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
Mail::Box \- manage a mailbox, a folder with messages
.SH "INHERITANCE"
.IX Header "INHERITANCE"
.Vb 2
\& Mail::Box
\&   is a Mail::Reporter
\&
\& Mail::Box is extended by
\&   Mail::Box::Dir
\&   Mail::Box::File
\&   Mail::Box::Net
.Ve
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 4
\& use Mail::Box::Manager;
\& my $mgr    = Mail::Box::Manager\->new;
\& my $folder = $mgr\->open(folder => $ENV{MAIL}, ...);
\& print $folder\->name;
\&
\& # Get the first message.
\& print $folder\->message(0);
\&
\& # Delete the third message
\& $folder\->message(3)\->delete;
\&
\& # Get the number of messages in scalar context.
\& my $emails = $folder\->messages;
\&
\& # Iterate over the messages.
\& foreach ($folder\->messages) {...} # all messages
\& foreach (@$folder) {...}          # all messages
\&
\& $folder\->addMessage(Mail::Box::Message\->new(...));
.Ve
.PP
Tied-interface:
.PP
.Vb 1
\& tie my(@inbox), \*(AqMail::Box::Tie::ARRAY\*(Aq, $inbox;
\&
\& # Four times the same:
\& $inbox[3]\->print;                 # tied
\& $folder\->[3]\->print;              # overloaded folder
\& $folder\->message(3)\->print;       # usual
\& print $folder\->[3];               # overloaded message
\&
\& tie my(%inbox), \*(AqMail::Box::Tie::HASH\*(Aq, $inbox;
\&
\& # Twice times the same
\& $inbox{$msgid}\->print;            # tied
\& $folder\->messageId($msgid)\->print;# usual
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
A Mail::Box::Manager creates \f(CW\*(C`Mail::Box\*(C'\fR objects.  But you already
knew, because you started with the Mail::Box\-Overview manual page.
That page is obligatory reading, sorry!
.PP
\&\f(CW\*(C`Mail::Box\*(C'\fR is the base class for accessing various types of mailboxes
(folders) in a uniform manner.  The various folder types vary on how
they store their messages, but when some effort those differences could
be hidden behind a general \s-1API\s0. For example, some folders store many
messages in one single file, where other store each message in a separate
file withing the same directory.
.PP
No object in your program will be of type \f(CW\*(C`Mail::Box\*(C'\fR: it is only used
as base class for the real folder types.  \f(CW\*(C`Mail::Box\*(C'\fR is extended by
.PP
Extends \*(L"\s-1DESCRIPTION\s0\*(R" in Mail::Reporter.
.SH "OVERLOADED"
.IX Header "OVERLOADED"
.ie n .IP "overload: \fB""""\fR" 4
.el .IP "overload: \fB``''\fR" 4
.IX Item "overload: """""
(stringification)
The folder objects stringify to their name.  This simplifies especially
print statements and sorting a lot.
.Sp
example: use overloaded folder as string
.Sp
.Vb 5
\& # Three lines with overloading: resp. cmp, @{}, and ""
\& foreach my $folder (sort @folders)
\& {   my $msgcount = @$folder;
\&     print "$folder contains $msgcount messages\en";
\& }
.Ve
.IP "overload: \fB@{}\fR" 4
.IX Item "overload: @{}"
When the folder is used as if it is a reference to an array, it will
show the messages, like \fImessages()\fR and \fImessage()\fR would do.
.Sp
example: use overloaded folder as array
.Sp
.Vb 2
\& my $msg = $folder\->[3];
\& my $msg = $folder\->message(3);          # same
\&
\& foreach my $msg (@$folder) ...
\& foreach my $msg ($folder\->messages) ... # same
.Ve
.IP "overload: \fBcmp\fR" 4
.IX Item "overload: cmp"
(string comparison) folders are compared based on their name.  The sort
rules are those of the build-in \f(CW\*(C`cmp\*(C'\fR.
.SH "METHODS"
.IX Header "METHODS"
Extends \*(L"\s-1METHODS\s0\*(R" in Mail::Reporter.
.SS "Constructors"
.IX Subsection "Constructors"
Extends \*(L"Constructors\*(R" in Mail::Reporter.
.IP "Mail::Box\->\fBnew\fR(%options)" 4
.IX Item "Mail::Box->new(%options)"
Open a new folder. A list of labeled \f(CW%options\fR for the mailbox can be
supplied. Some options pertain to Mail::Box, and others are added by
sub-classes.
.Sp
To control delay-loading of messages, as well the headers as the bodies,
a set of \f(CW*_type\fR options are available. \f(CW\*(C`extract\*(C'\fR determines whether
we want delay-loading.
.Sp
.Vb 10
\& \-Option           \-\-Defined in     \-\-Default
\&  access                              \*(Aqr\*(Aq
\&  body_delayed_type                   Mail::Message::Body::Delayed
\&  body_type                           <folder specific>
\&  coerce_options                      []
\&  create                              <false>
\&  extract                             10240
\&  field_type                          undef
\&  fix_headers                         <false>
\&  folder                              $ENV{MAIL}
\&  folderdir                           undef
\&  head_delayed_type                   Mail::Message::Head::Delayed
\&  head_type                           Mail::Message::Head::Complete
\&  keep_dups                           <false>
\&  lock_file                           undef
\&  lock_timeout                        1 hour
\&  lock_type                           Mail::Box::Locker::DotLock
\&  lock_wait                           10 seconds
\&  locker                              undef
\&  log                Mail::Reporter   \*(AqWARNINGS\*(Aq
\&  manager                             undef
\&  message_type                        <folder\-class>::Message
\&  multipart_type                      Mail::Message::Body::Multipart
\&  remove_when_empty                   <true>
\&  save_on_exit                        <true>
\&  trace              Mail::Reporter   \*(AqWARNINGS\*(Aq
\&  trusted                             <depends on folder location>
.Ve
.RS 4
.IP "access => \s-1MODE\s0" 2
.IX Item "access => MODE"
Access-rights to the folder.  Folders are opened for read-only (which
means write-protected) by default! \s-1MODE\s0 can be
.RS 2
.ie n .IP "\*(Aqr\*(Aq: read-only (default)" 4
.el .IP "\f(CW\*(Aqr\*(Aq\fR: read-only (default)" 4
.IX Item "r: read-only (default)"
.PD 0
.ie n .IP "\*(Aqa\*(Aq: append" 4
.el .IP "\f(CW\*(Aqa\*(Aq\fR: append" 4
.IX Item "a: append"
.ie n .IP "\*(Aqrw\*(Aq: read-write" 4
.el .IP "\f(CW\*(Aqrw\*(Aq\fR: read-write" 4
.IX Item "rw: read-write"
.ie n .IP "\*(Aqd\*(Aq: delete" 4
.el .IP "\f(CW\*(Aqd\*(Aq\fR: delete" 4
.IX Item "d: delete"
.RE
.RS 2
.PD
.Sp
These \s-1MODE\s0 has no relation to the modes actually used to open the folder
files within this module.  For instance, if you specify \f(CW"rw"\fR, and
open the folder, only read permission on the folder-file is required.
.Sp
Be warned: writing a \s-1MBOX\s0 folder may create a new file to replace the old
folder.  The permissions and owner of the file may get changed by this.
.RE
.IP "body_delayed_type => \s-1CLASS\s0" 2
.IX Item "body_delayed_type => CLASS"
The bodies which are delayed: which will be read from file when it
is needed, but not before.
.IP "body_type => CLASS|CODE" 2
.IX Item "body_type => CLASS|CODE"
When messages are read from a folder-file, the headers will be stored in
a \f(CW\*(C`head_type\*(C'\fR object.  For the body, however, there is a range of
choices about type, which are all described in Mail::Message::Body.
.Sp
Specify a CODE-reference which produces the body-type to be created, or
a \s-1CLASS\s0 of the body which is used when the body is not a multipart or
nested.  In case of a code reference, the header structure is passed as
first argument to the routine.
.Sp
Do \fInot\fR return a delayed body-type (like \f(CW\*(C`::Delayed\*(C'\fR), because that is
determined by the \f(CW\*(C`extract\*(C'\fR option while the folder is opened.  Even
delayed message will require some real body type when they get parsed
eventually.  Multiparts and nested messages are also outside your control.
.Sp
For instance:
.Sp
.Vb 1
\& $mgr\->open(\*(AqInBox\*(Aq, body_type => \e&which_body);
\&
\& sub which_body($) {
\&     my $head = shift;
\&     my $size = $head\->guessBodySize || 0;
\&     my $type = $size > 100000 ? \*(AqFile\*(Aq : \*(AqLines\*(Aq;
\&     "Mail::Message::Body::$type";
\& }
.Ve
.Sp
The default depends on the mail-folder type, although the general default
is Mail::Message::Body::Lines.  Please check the applicable
manual pages.
.IP "coerce_options => \s-1ARRAY\s0" 2
.IX Item "coerce_options => ARRAY"
Keep configuration information for messages which are coerced into the
specified folder type, starting with a different folder type (or even
no folder at all).
Messages which are coerced are always fully read, so this kind of information
does not need to be kept here.
.IP "create => \s-1BOOLEAN\s0" 2
.IX Item "create => BOOLEAN"
Automatically create the folder when it does not exist yet.  This will only
work when access is granted for writing or appending to the folder.
.Sp
Be careful: you may create a different folder type than you expect unless you
explicitly specify Mail::Box::Manager::open(type).
.IP "extract => \s-1INTEGER\s0 | \s-1CODE\s0 | \s-1METHOD\s0 | '\s-1LAZY\s0'|'\s-1ALWAYS\s0'" 2
.IX Item "extract => INTEGER | CODE | METHOD | 'LAZY'|'ALWAYS'"
Defines when to parse (process) the content of the message.
When the header of a message is read, you may want to postpone the
reading of the body: header information is more often needed than
the body data, so why parse it always together?  The cost of delaying
is not too high, and with some luck you may never need parsing the body.
.Sp
If you supply an \s-1INTEGER\s0 to this option, bodies of those messages with a
total size less than that number will be extracted from the folder only
when necessary.  Messages where the size (in the \f(CW\*(C`Content\-Length\*(C'\fR field)
is not included in the header, like often the case for multiparts and nested
messages, will not be extracted by default.
.Sp
If you supply a \s-1CODE\s0 reference, that subroutine is called every time
that the extraction mechanism wants to determine whether to parse the
body or not. The subroutine is called with the following arguments:
.Sp
.Vb 1
\& CODE\->(FOLDER, HEAD)
.Ve
.Sp
where \s-1FOLDER\s0 is a reference to the folder we are reading.  \s-1HEAD\s0 refers to the
Mail::Message::Head::Complete head of the message at hand.  The routine must
return a \f(CW\*(C`true\*(C'\fR value (extract now) or a \f(CW\*(C`false\*(C'\fR value (be lazy, do not
parse yet).  Think about using the \fIMail::Message::Head::guessBodySize()\fR and
\&\fIMail::Message::guessTimestamp()\fR on the header to determine your choice.
.Sp
The third possibility is to specify the \s-1NAME\s0 of a method.  In that case,
for each message is called:
.Sp
.Vb 1
\& FOLDER\->NAME(HEAD)
.Ve
.Sp
Where each component has the same meaning as described above.
.Sp
The fourth way to use this option involves constants: with \f(CW\*(C`LAZY\*(C'\fR
all messages will be delayed. With \f(CW\*(C`ALWAYS\*(C'\fR you enforce unconditional
parsing, no delaying will take place.  The latter is usuful when you are
sure you always need all the messages in the folder.
.Sp
.Vb 2
\& $folder\->new(extract => \*(AqLAZY\*(Aq);  # Very lazy
\& $folder\->new(extract => 10000);   # Less than 10kB
\&
\& # same, but implemented yourself
\& $folder\->new(extract => &large);
\& sub large($) {
\&    my ($f, $head) = @_;
\&    my $size = $head\->guessBodySize;
\&    defined $size ? $size < 10000 : 1
\& };
\&
\& # method call by name, useful for Mail::Box
\& # extensions. The example selects all messages
\& # sent by you to be loaded without delay.
\& # Other messages will be delayed.
\& $folder\->new(extract => \*(Aqsent_by_me\*(Aq);
\& sub Mail::Box::send_by_me($) {
\&     my ($self, $header) = @_;
\&     $header\->get(\*(Aqfrom\*(Aq) =~ m/\ebmy\e@example.com\eb/i;
\& }
.Ve
.IP "field_type => \s-1CLASS\s0" 2
.IX Item "field_type => CLASS"
The type of the fields to be used in a header. Must extend
Mail::Message::Field.
.IP "fix_headers => \s-1BOOLEAN\s0" 2
.IX Item "fix_headers => BOOLEAN"
Broken \s-1MIME\s0 headers usually stop the parser: all lines not parsed are
added to the body of the message.  With this flag set, the erroneous line
is added to the previous header field and parsing is continued.
See Mail::Box::Parser::Perl::new(fix_header_errors).
.IP "folder => \s-1FOLDERNAME\s0" 2
.IX Item "folder => FOLDERNAME"
Which folder to open (for reading or writing). When used for reading (the
\&\f(CW\*(C`access\*(C'\fR option set to \f(CW"r"\fR or \f(CW"a"\fR) the mailbox should already exist
and must be readable. The file or directory of the mailbox need not exist if it
is opened for reading and writing (\f(CW"rw"\fR).  Write-permission is checked when
opening an existing mailbox.
.Sp
The folder name can be preceded by a \f(CW"="\fR, to indicate that it is named
relative to the directory specified in new(folderdir).  Otherwise, it is
taken as relative or absolute path.
.IP "folderdir => \s-1DIRECTORY\s0" 2
.IX Item "folderdir => DIRECTORY"
Where are folders to be found by default?  A folder-name may be preceded by
a equals-sign (\f(CW\*(C`=\*(C'\fR, a \f(CW\*(C`mutt\*(C'\fR convension) to explicitly state that the folder
is located below the default directory.  For example: in case
\&\f(CW\*(C`folderdir => \*(Aq/tmp\*(Aq\*(C'\fR and \f(CW\*(C`folder => \*(Aq=abc\*(Aq\*(C'\fR, the name of the
folder-file is \f(CW\*(Aq/tmp/abc\*(Aq\fR.  Each folder type has already some default set.
.IP "head_delayed_type => \s-1CLASS\s0" 2
.IX Item "head_delayed_type => CLASS"
The headers which are delayed: which will be read from file when it
is needed, but not before.
.IP "head_type => \s-1CLASS\s0" 2
.IX Item "head_type => CLASS"
The type of header which contains all header information.  Must extend
Mail::Message::Head::Complete.
.IP "keep_dups => \s-1BOOLEAN\s0" 2
.IX Item "keep_dups => BOOLEAN"
Indicates whether or not duplicate messages within the folder should          
be retained.  A message is considered to be a duplicate if its message-id      
is the same as a previously parsed message within the same folder. If this         
option is false (the default) such messages are automatically deleted,
because it is considered useless to store the same message twice.
.IP "lock_file => \s-1FILENAME\s0" 2
.IX Item "lock_file => FILENAME"
The name of the file which is used to lock.  This must be specified when
locking is to be used.
.IP "lock_timeout => \s-1SECONDS\s0" 2
.IX Item "lock_timeout => SECONDS"
When the lock file is older than the specified number of \s-1SECONDS\s0, it is
considered a mistake.  The original lock is released, and accepted for
this folder.
.IP "lock_type => CLASS|STRING|ARRAY" 2
.IX Item "lock_type => CLASS|STRING|ARRAY"
The type of the locker object.  This may be the full name of a \s-1CLASS\s0
which extends Mail::Box::Locker, or one of the known locker types
\&\f(CW\*(C`DotLock\*(C'\fR, \f(CW\*(C`Flock\*(C'\fR, \f(CW\*(C`Mutt\*(C'\fR, \f(CW\*(C`NFS\*(C'\fR, \f(CW\*(C`POSIX\*(C'\fR, or \f(CW\*(C`NONE\*(C'\fR.  If an \s-1ARRAY\s0
is specified, then a Multi locker is built which uses the specified list.
.IP "lock_wait => \s-1SECONDS\s0" 2
.IX Item "lock_wait => SECONDS"
\&\s-1SECONDS\s0 to wait before failing on opening this folder.
.IP "locker => \s-1OBJECT\s0" 2
.IX Item "locker => OBJECT"
An \s-1OBJECT\s0 which extends Mail::Box::Locker, and will handle folder locking
replacing the default lock behavior.
.IP "log => \s-1LEVEL\s0" 2
.IX Item "log => LEVEL"
.PD 0
.IP "manager => \s-1MANAGER\s0" 2
.IX Item "manager => MANAGER"
.PD
A reference to the object which manages this folder \*(-- typically an
Mail::Box::Manager instance.
.IP "message_type => \s-1CLASS\s0" 2
.IX Item "message_type => CLASS"
What kind of message objects are stored in this type of folder.  The
default is constructed from the folder class followed by \f(CW\*(C`::Message\*(C'\fR.
For instance, the message type for \f(CW\*(C`Mail::Box::POP3\*(C'\fR is
\&\f(CW\*(C`Mail::Box::POP3::Message\*(C'\fR
.IP "multipart_type => \s-1CLASS\s0" 2
.IX Item "multipart_type => CLASS"
The default type of objects which are to be created for multipart message
bodies.
.IP "remove_when_empty => \s-1BOOLEAN\s0" 2
.IX Item "remove_when_empty => BOOLEAN"
Determines whether to remove the folder file or directory
automatically when the write would result in a folder without
messages nor sub-folders.
.IP "save_on_exit => \s-1BOOLEAN\s0" 2
.IX Item "save_on_exit => BOOLEAN"
Sets the policy for saving the folder when it is closed.
A folder can be closed manually (see \fIclose()\fR) or in a number of
implicit ways, including on the moment the program is terminated.
.IP "trace => \s-1LEVEL\s0" 2
.IX Item "trace => LEVEL"
.PD 0
.IP "trusted => \s-1BOOLEAN\s0" 2
.IX Item "trusted => BOOLEAN"
.PD
Flags whether to trust the data in the folder or not.  Folders which
reside in your \f(CW\*(C`folderdir\*(C'\fR will be trusted by default (even when the
names if not specified staring with \f(CW\*(C`=\*(C'\fR).  Folders which are outside
the folderdir or read from \s-1STDIN\s0 (\fIMail::Message::Construct::read()\fR) are
not trused by default, and require some extra checking.
.Sp
If you do not check encodings of received messages, you may print
binary data to the screen, which is a security risk.
.RE
.RS 4
.RE
.SS "The folder"
.IX Subsection "The folder"
.ie n .IP "$obj\->\fBaddMessage\fR($message, %options)" 4
.el .IP "\f(CW$obj\fR\->\fBaddMessage\fR($message, \f(CW%options\fR)" 4
.IX Item "$obj->addMessage($message, %options)"
Add a message to the folder.  A message is usually a
Mail::Box::Message object or a sub-class thereof.  The message
shall not be in an other folder, when you use this method.
In case it is, use \fIMail::Box::Manager::moveMessage()\fR or
\&\fIMail::Box::Manager::copyMessage()\fR via the manager.
.Sp
Messages with id's which already exist in this folder are not added.
.Sp
\&\s-1BE\s0 \s-1WARNED\s0 that message labels may get lost when a message is moved from
one folder type to an other.  An attempt is made to translate labels,
but there are many differences in interpretation by applications.
.Sp
.Vb 2
\& \-Option\-\-Default
\&  share   <not used>
.Ve
.RS 4
.IP "share => \s-1BOOLEAN\s0" 2
.IX Item "share => BOOLEAN"
Try to share the physical resource of the current message with the
indicated message.  It is sometimes possible to share messages between
different folder types.  When the sharing is not possible, than this
option is simply ignored.
.Sp
Sharing the resource is quite dangerous, and only available for a
limited number of folder types, at the moment only some Mail::Box::Dir
folders; these file-based messages can be hardlinked (on platforms that
support it).  The link may get broken when one message is modified in one
of the folders.... but maybe not, depending on the folder types involved.
.RE
.RS 4
.Sp
example:
.Sp
.Vb 2
\& $folder\->addMessage($msg);
\& $folder\->addMessages($msg1, $msg2, ...);
.Ve
.RE
.ie n .IP "$obj\->\fBaddMessages\fR(@messages)" 4
.el .IP "\f(CW$obj\fR\->\fBaddMessages\fR(@messages)" 4
.IX Item "$obj->addMessages(@messages)"
Adds a set of message objects to the open folder at once.  For some folder
types this may be faster than adding them one at a time.
.Sp
example:
.Sp
.Vb 1
\& $folder\->addMessages($msg1, $msg2, ...);
.Ve
.IP "Mail::Box\->\fBappendMessages\fR(%options)" 4
.IX Item "Mail::Box->appendMessages(%options)"
Append one or more messages to an unopened folder.
Usually, this method is called by the \fIMail::Box::Manager::appendMessage()\fR,
in which case the correctness of the folder type is checked.
.Sp
For some folder types it is required to open the folder before it can
be used for appending.  This can be fast, but this can also be very
slow (depends on the implementation).  All \f(CW%options\fR passed will also be
used to open the folder, if needed.
.Sp
.Vb 5
\& \-Option  \-\-Default
\&  folder    <required>
\&  message   undef
\&  messages  undef
\&  share     <false>
.Ve
.RS 4
.IP "folder => \s-1FOLDERNAME\s0" 2
.IX Item "folder => FOLDERNAME"
The name of the folder to which the messages are to be appended.  The folder
implementation will avoid opening the folder when possible, because this is
resource consuming.
.IP "message => \s-1MESSAGE\s0" 2
.IX Item "message => MESSAGE"
.PD 0
.IP "messages => ARRAY-OF-MESSAGES" 2
.IX Item "messages => ARRAY-OF-MESSAGES"
.PD
One reference to a \s-1MESSAGE\s0 or a reference to an \s-1ARRAY\s0 of MESSAGEs, which may
be of any type.  The messages will be first coerced into the correct
message type to fit in the folder, and then will be added to it.
.IP "share => \s-1BOOLEAN\s0" 2
.IX Item "share => BOOLEAN"
Try to share physical storage of the message.  Only available for a
limited number of folder types, otherwise no-op.
.RE
.RS 4
.Sp
example:
.Sp
.Vb 6
\& my $message = Mail::Message\->new(...);
\& Mail::Box::Mbox\->appendMessages
\&  ( folder    => \*(Aq=xyz\*(Aq
\&  , message   => $message
\&  , folderdir => $ENV{FOLDERS}
\&  );
.Ve
.Sp
better:
.Sp
.Vb 2
\& my Mail::Box::Manager $mgr;
\& $mgr\->appendMessages($message, folder => \*(Aq=xyz\*(Aq);
.Ve
.RE
.ie n .IP "$obj\->\fBclose\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBclose\fR(%options)" 4
.IX Item "$obj->close(%options)"
Close the folder, which usually implies writing the changes.  This will
return \f(CW\*(C`false\*(C'\fR when writing is required but fails.  Please do check this
result.
.Sp
\&\s-1WARNING:\s0 When moving messages from one folder to another, be sure to
write the destination folder before writing and closing the source
folder.  Otherwise you may lose data if the system crashes or if there
are software problems.
.Sp
.Vb 4
\& \-Option      \-\-Default
\&  force         <false>
\&  save_deleted  false
\&  write         MODIFIED
.Ve
.RS 4
.IP "force => \s-1BOOLEAN\s0" 2
.IX Item "force => BOOLEAN"
Override the new(access) setting which was specified when the folder
was opened. This option only has an effect if its value is \s-1TRUE\s0. \s-1NOTE:\s0
Writing to the folder may not be permitted by the operating system,
in which case even \f(CW\*(C`force\*(C'\fR will not help.
.IP "save_deleted => \s-1BOOLEAN\s0" 2
.IX Item "save_deleted => BOOLEAN"
Do also write messages which where flagged to be deleted to their folder.  The
flag for deletion is conserved (when possible), which means that a re-open of
the folder may remove the messages for real.  See write(save_deleted).
.IP "write => '\s-1ALWAYS\s0'|'\s-1NEVER\s0'|'\s-1MODIFIED\s0'" 2
.IX Item "write => 'ALWAYS'|'NEVER'|'MODIFIED'"
Specifies whether the folder should be written.  As could be expected,
\&\f(CW\*(C`ALWAYS\*(C'\fR means always (even if there are no changes), \f(CW\*(C`NEVER\*(C'\fR means
that changes to the folder will be lost, and \f(CW\*(C`MODIFIED\*(C'\fR only saves the
folder if there are any changes.
.RE
.RS 4
.Sp
example:
.Sp
.Vb 2
\& my $f = $mgr\->open(\*(Aqspam\*(Aq, access => \*(Aqrw\*(Aq)
\&     or die "Cannot open spam: $!\en";
\&
\& $f\->message(0)\->delete
\&     if $f\->messages;
\&
\& $f\->close
\&     or die "Couldn\*(Aqt write $f: $!\en";
.Ve
.RE
.ie n .IP "$obj\->\fBcopyTo\fR($folder, %options)" 4
.el .IP "\f(CW$obj\fR\->\fBcopyTo\fR($folder, \f(CW%options\fR)" 4
.IX Item "$obj->copyTo($folder, %options)"
Copy the folder's messages to a new folder.  The new folder may be of
a different type.
.Sp
.Vb 5
\& \-Option       \-\-Default
\&  delete_copied  <false>
\&  select         \*(AqACTIVE\*(Aq
\&  share          <not used>
\&  subfolders     <folder type dependent>
.Ve
.RS 4
.IP "delete_copied => \s-1BOOLEAN\s0" 2
.IX Item "delete_copied => BOOLEAN"
Flag the messages from the source folder to be deleted, just after it
was copied.  The deletion will only take effect when the originating
folder is closed.
.IP "select => '\s-1ACTIVE\s0'|'\s-1DELETED\s0'|'\s-1ALL\s0'|LABEL|!LABEL|FILTER" 2
.IX Item "select => 'ACTIVE'|'DELETED'|'ALL'|LABEL|!LABEL|FILTER"
Which messages are to be copied. See the description of \fImessages()\fR
about how this works.
.IP "share => \s-1BOOLEAN\s0" 2
.IX Item "share => BOOLEAN"
Try to share the message between the folders.  Some Mail::Box::Dir
folder types do support it by creating a hardlink (on UNIX/Linux).
.IP "subfolders => BOOLEAN|'\s-1FLATTEN\s0'|'\s-1RECURSE\s0'" 2
.IX Item "subfolders => BOOLEAN|'FLATTEN'|'RECURSE'"
How to handle sub-folders.  When false (\f(CW0\fR or \f(CW\*(C`undef\*(C'\fR), sub-folders
are simply ignored.  With \f(CW\*(C`FLATTEN\*(C'\fR, messages from sub-folders are
included in the main copy.  \f(CW\*(C`RECURSE\*(C'\fR recursively copies the
sub-folders as well.  By default, when the destination folder
supports sub-folders \f(CW\*(C`RECURSE\*(C'\fR is used, otherwise \f(CW\*(C`FLATTEN\*(C'\fR.  A value
of true will select the default.
.RE
.RS 4
.Sp
example:
.Sp
.Vb 4
\& my $mgr  = Mail::Box::Manager\->new;
\& my $imap = $mgr\->open(type => \*(Aqimap\*(Aq, host => ...);
\& my $mh   = $mgr\->open(type => \*(Aqmh\*(Aq, folder => \*(Aq/tmp/mh\*(Aq,
\&     create => 1, access => \*(Aqw\*(Aq);
\&
\& $imap\->copyTo($mh, delete_copied => 1);
\& $mh\->close; $imap\->close;
.Ve
.RE
.ie n .IP "$obj\->\fBdelete\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBdelete\fR(%options)" 4
.IX Item "$obj->delete(%options)"
Remove the specified folder file or folder directory (depending on
the type of folder) from disk.  Of course, \s-1THIS\s0 \s-1IS\s0 \s-1DANGEROUS:\s0 you \*(L"may\*(R"
lose data.  Returns a \f(CW\*(C`true\*(C'\fR value on success.
.Sp
\&\s-1WARNING:\s0 When moving messages from one folder to another, be sure to write the
destination folder before deleting the source folder.  Otherwise you may lose
data if the system crashes or if there are software problems.
.Sp
.Vb 2
\& \-Option   \-\-Default
\&  recursive  1
.Ve
.RS 4
.IP "recursive => \s-1BOOLEAN\s0" 2
.IX Item "recursive => BOOLEAN"
.RE
.RS 4
.Sp
example: removing an open folder
.Sp
.Vb 3
\& my $folder = Mail::Box::Mbox\->new(folder => \*(AqInBox\*(Aq, access => \*(Aqrw\*(Aq);
\& ... some other code ...
\& $folder\->delete;
.Ve
.Sp
example: removing an closed folder
.Sp
.Vb 2
\& my $folder = Mail::Box::Mbox\->new(folder => \*(AqINBOX\*(Aq, access => \*(Aqd\*(Aq);
\& $folder\->delete;
.Ve
.RE
.ie n .IP "$obj\->\fBfolderdir\fR( [$directory] )" 4
.el .IP "\f(CW$obj\fR\->\fBfolderdir\fR( [$directory] )" 4
.IX Item "$obj->folderdir( [$directory] )"
Get or set the \f(CW$directory\fR which is used to store mail-folders by default.
.Sp
example:
.Sp
.Vb 2
\& print $folder\->folderdir;
\& $folder\->folderdir("$ENV{HOME}/nsmail");
.Ve
.ie n .IP "$obj\->\fBname\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBname\fR()" 4
.IX Item "$obj->name()"
Returns the name of the folder.  What the name represents depends on
the actual type of mailbox used.
.Sp
example:
.Sp
.Vb 2
\& print $folder\->name;
\& print "$folder";       # overloaded stringification
.Ve
.ie n .IP "$obj\->\fBorganization\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBorganization\fR()" 4
.IX Item "$obj->organization()"
Returns how the folder is organized: as one \f(CW\*(C`FILE\*(C'\fR with many messages,
a \f(CW\*(C`DIRECTORY\*(C'\fR with one message per file, or by a \f(CW\*(C`REMOTE\*(C'\fR server.
.ie n .IP "$obj\->\fBsize\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBsize\fR()" 4
.IX Item "$obj->size()"
Returns the size of the folder in bytes, not counting in the deleted
messages.  The error in the presented result may be as large as 10%,
because the in-memory representation of messages is not always the
same as the size when they are written.
.ie n .IP "$obj\->\fBtype\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBtype\fR()" 4
.IX Item "$obj->type()"
Returns a name for the type of mail box.  This can be \f(CW\*(C`mbox\*(C'\fR, \f(CW\*(C`mh\*(C'\fR,
\&\f(CW\*(C`maildir\*(C'\fR, or \f(CW\*(C`pop3\*(C'\fR.
.ie n .IP "$obj\->\fBupdate\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBupdate\fR(%options)" 4
.IX Item "$obj->update(%options)"
Read new messages from the folder, which where received after opening
it. This is quite dangerous and shouldn't be possible: folders which
are open are locked. However, some applications do not use locks or the
wrong kind of locks. This method reads the changes (not always failsafe)
and incorporates them in the open folder administration.
.Sp
The \f(CW%options\fR are extra values which are passed to the
\&\fIupdateMessages()\fR method which is doing the actual work here.
.ie n .IP "$obj\->\fBurl\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBurl\fR()" 4
.IX Item "$obj->url()"
Represent the folder as a \s-1URL\s0 (Universal Resource Locator) string.  You may
pass such a \s-1URL\s0 as folder name to \fIMail::Box::Manager::open()\fR.
.Sp
example:
.Sp
.Vb 4
\& print $folder\->url;
\& # may result in
\& #   mbox:/var/mail/markov   or
\& #   pop3://user:password@pop.aol.com:101
.Ve
.SS "Folder flags"
.IX Subsection "Folder flags"
.ie n .IP "$obj\->\fBaccess\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBaccess\fR()" 4
.IX Item "$obj->access()"
Returns the access mode of the folder, as set by new(access)
.ie n .IP "$obj\->\fBisModified\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBisModified\fR()" 4
.IX Item "$obj->isModified()"
Checks if the folder, as stored in memory, is modified.  A true value is
returned when any of the messages is to be deleted, has changed, or messages
were added after the folder was read from file.
.Sp
\&\s-1WARNING:\s0 this flag is not related to an external change to the folder
structure on disk.  Have a look at \fIupdate()\fR for that.
.ie n .IP "$obj\->\fBmodified\fR( [\s-1BOOLEAN\s0] )" 4
.el .IP "\f(CW$obj\fR\->\fBmodified\fR( [\s-1BOOLEAN\s0] )" 4
.IX Item "$obj->modified( [BOOLEAN] )"
Sets whether the folder is modified or not.
.ie n .IP "$obj\->\fBwritable\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBwritable\fR()" 4
.IX Item "$obj->writable()"
Checks whether the current folder is writable.
.Sp
example:
.Sp
.Vb 1
\& $folder\->addMessage($msg) if $folder\->writable;
.Ve
.SS "The messages"
.IX Subsection "The messages"
.ie n .IP "$obj\->\fBcurrent\fR( [$number|$message|$message_id] )" 4
.el .IP "\f(CW$obj\fR\->\fBcurrent\fR( [$number|$message|$message_id] )" 4
.IX Item "$obj->current( [$number|$message|$message_id] )"
Some mail-readers keep the \fIcurrent\fR message, which represents the last
used message.  This method returns [after setting] the current message.
You may specify a \f(CW$number\fR, to specify that that message number is to be
selected as current, or a \f(CW$message\fR/$message_id (as long as you are sure
that the header is already loaded, otherwise they are not recognized).
.Sp
example:
.Sp
.Vb 2
\& $folder\->current(0);
\& $folder\->current($message);
.Ve
.ie n .IP "$obj\->\fBfind\fR($message_id)" 4
.el .IP "\f(CW$obj\fR\->\fBfind\fR($message_id)" 4
.IX Item "$obj->find($message_id)"
Like \fImessageId()\fR, this method searches for a message with the
\&\f(CW$message_id\fR, returning the corresponding message object.  However, \f(CW\*(C`find\*(C'\fR
will cause unparsed message in the folder to be parsed until the message-id
is found.  The folder will be scanned back to front.
.ie n .IP "$obj\->\fBfindFirstLabeled\fR( $label, [\s-1BOOLEAN\s0, [$msgs]] )" 4
.el .IP "\f(CW$obj\fR\->\fBfindFirstLabeled\fR( \f(CW$label\fR, [\s-1BOOLEAN\s0, [$msgs]] )" 4
.IX Item "$obj->findFirstLabeled( $label, [BOOLEAN, [$msgs]] )"
Find the first message which has this \f(CW$label\fR with the correct setting. The
\&\s-1BOOLEAN\s0 indicates whether any true value or any false value is to be
found in the \s-1ARRAY\s0 of \f(CW$msgs\fR.  By default, a true value is searched for.
When a message does not have the requested label, it is taken as false.
.Sp
example: looking for a labeled message
.Sp
.Vb 1
\& my $current = $folder\->findFirstLabeled(\*(Aqcurrent\*(Aq);
\&
\& my $first   = $folder\->findFirstLabeled(seen => 0);
\&
\& my $last    = $folder\->findFirstLabeled(seen => 0,
\&                 [ reverse $self\->messages(\*(AqACTIVE\*(Aq) ] )
.Ve
.ie n .IP "$obj\->\fBmessage\fR( $index, [$message] )" 4
.el .IP "\f(CW$obj\fR\->\fBmessage\fR( \f(CW$index\fR, [$message] )" 4
.IX Item "$obj->message( $index, [$message] )"
Get or set a message with on a certain index.  Messages which are flagged
for deletion are counted.  Negative indexes start at the end of the folder.
.Sp
example:
.Sp
.Vb 4
\& my $msg = $folder\->message(3);
\& $folder\->message(3)\->delete;   # status changes to \`deleted\*(Aq
\& $folder\->message(3, $msg);
\& print $folder\->message(\-1);    # last message.
.Ve
.ie n .IP "$obj\->\fBmessageId\fR( $message_id, [$message] )" 4
.el .IP "\f(CW$obj\fR\->\fBmessageId\fR( \f(CW$message_id\fR, [$message] )" 4
.IX Item "$obj->messageId( $message_id, [$message] )"
With one argument, returns the message in the folder with the specified
\&\f(CW$message_id\fR. If a reference to a message object is passed as the optional
second argument, the message is first stored in the folder, replacing any
existing message whose message \s-1ID\s0 is \f(CW$message_id\fR. (The message \s-1ID\s0 of \f(CW$message\fR
need not match \f(CW$message_id\fR.)
.Sp
!!WARNING!!: when the message headers are delay-parsed, the message
might be in the folder but not yet parsed into memory. In this case, use
\&\fIfind()\fR instead of \f(CW\*(C`messageId()\*(C'\fR if you really need a thorough search.
This is especially the case for directory organized folders without
special indexi, like Mail::Box::MH.
.Sp
The \f(CW$message_id\fR may still be in angles, which will be stripped.  In that
case blanks (which origin from header line folding) are removed too.  Other
info around the angles will be removed too.
.Sp
example:
.Sp
.Vb 4
\& my $msg = $folder\->messageId(\*(Aq<complex\-message.id>\*(Aq);
\& $folder\->messageId("<complex\-message\en.id>", $msg);
\& my $msg = $folder\->messageId(\*(Aqcomplex\-message.id\*(Aq);
\& my $msg = $folder\->messageId(\*(Aqgarbage <complex\-message.id> trash\*(Aq);
.Ve
.ie n .IP "$obj\->\fBmessageIds\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBmessageIds\fR()" 4
.IX Item "$obj->messageIds()"
Returns a list of \fIall\fR message-ids in the folder, including
those of messages which are to be deleted.
.Sp
For some folder-types (like \s-1MH\s0), this method may cause all message-files
to be read.  See their respective manual pages.
.Sp
example:
.Sp
.Vb 3
\& foreach my $id ($folder\->messageIds) {
\&    $folder\->messageId($id)\->print;
\& }
.Ve
.ie n .IP "$obj\->\fBmessages\fR( <'\s-1ALL\s0'|$range|'\s-1ACTIVE\s0'|'\s-1DELETED\s0'|$label| !$label|$filter> )" 4
.el .IP "\f(CW$obj\fR\->\fBmessages\fR( <'\s-1ALL\s0'|$range|'\s-1ACTIVE\s0'|'\s-1DELETED\s0'|$label| !$label|$filter> )" 4
.IX Item "$obj->messages( <'ALL'|$range|'ACTIVE'|'DELETED'|$label| !$label|$filter> )"
Returns multiple messages from the folder.  The default is \f(CW\*(C`ALL\*(C'\fR
which will return (as expected maybe) all the messages in the
folder.  The \f(CW\*(C`ACTIVE\*(C'\fR flag will return the messages not flagged for
deletion.  This is the opposite of \f(CW\*(C`DELETED\*(C'\fR, which returns all
messages from the folder which will be deleted when the folder is
closed.
.Sp
You may also specify a \f(CW$range:\fR two numbers specifying begin and end
index in the array of messages.  Negative indexes count from the
end of the folder.  When an index is out-of-range, the returned
list will be shorter without complaints.
.Sp
Everything else than the predefined names is seen as labels.  The messages
which have that label set will be returned.  When the sequence starts
with an exclamation mark (!), the search result is reversed.
.Sp
For more complex searches, you can specify a \f(CW$filter\fR, which is
simply a code reference.  The message is passed as only argument.
.Sp
example:
.Sp
.Vb 2
\& foreach my $message ($folder\->messages) {...}
\& foreach my $message (@$folder) {...}
\&
\& # twice the same
\& my @messages   = $folder\->messages;
\& my @messages   = $folder\->messages(\*(AqALL\*(Aq);
\&
\& # Selection based on a range (begin, end)
\& my $subset     = $folder\->messages(10,\-8);
\&
\& # twice the same:
\& my @not_deleted= grep {not $_\->isDeleted}
\&                     $folder\->messages;
\& my @not_deleted= $folder\->messages(\*(AqACTIVE\*(Aq);
\&
\& # scalar context the number of messages
\& my $nr_of_msgs = $folder\->messages;
\&
\& # third message, via overloading
\& $folder\->[2];
\&
\& # Selection based on labels
\& $mgr\->moveMessages($spam, $inbox\->message(\*(Aqspam\*(Aq));
\& $mgr\->moveMessages($archive, $inbox\->message(\*(Aqseen\*(Aq));
.Ve
.ie n .IP "$obj\->\fBnrMessages\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBnrMessages\fR(%options)" 4
.IX Item "$obj->nrMessages(%options)"
Simply calls \fImessages()\fR in scalar context to return a count instead
of the messages itself.  Some people seem to understand this better.
Note that \fInrMessages()\fR will default to returning a count of
\&\f(CW\*(C`ALL\*(C'\fR messages in the folder, including both \f(CW\*(C`ACTIVE\*(C'\fR and \f(CW\*(C`DELETED\*(C'\fR.
.Sp
The \f(CW%options\fR are passed to (and explained in) \fImessages()\fR.
.ie n .IP "$obj\->\fBscanForMessages\fR($message, $message_ids, $timespan, $window)" 4
.el .IP "\f(CW$obj\fR\->\fBscanForMessages\fR($message, \f(CW$message_ids\fR, \f(CW$timespan\fR, \f(CW$window\fR)" 4
.IX Item "$obj->scanForMessages($message, $message_ids, $timespan, $window)"
You start with a \f(CW$message\fR, and are looking for a set of messages
which are related to it.  For instance, messages which appear in
the 'In\-Reply\-To' and 'Reference' header fields of that message.
These messages are known by their \f(CW$message_ids\fR and you want to find
them in the folder.
.Sp
When all message-ids are known, then looking-up messages is simple:
they are found in a plain hash using \fImessageId()\fR.  But Mail::Box
is lazy where it can, so many messages may not have been read from
file yet, and that's the preferred situation, because that saves
time and memory.
.Sp
It is not smart to search for the messages from front to back in
the folder: the chances are much higher that related message
reside closely to each other.  Therefore, this method starts
scanning the folder from the specified \f(CW$message\fR, back to the front
of the folder.
.Sp
The \f(CW$timespan\fR can be used to terminate the search based on the time
enclosed in the message.  When the constant string \f(CW\*(C`EVER\*(C'\fR is used as
\&\f(CW$timespan\fR, then the search is not limited by that.  When an integer
is specified, it will be used as absolute time in time-ticks as
provided by your platform dependent \f(CW\*(C`time\*(C'\fR function.  In other cases,
it is passed to \fItimespan2seconds()\fR to determine the threshold
as time relative to the message's time.
.Sp
The \f(CW$window\fR is used to limit the search in number of messages to be
scanned as integer or constant string \f(CW\*(C`ALL\*(C'\fR.
.Sp
Returned are the message-ids which were not found during the scan.
Be warned that a message-id could already be known and therefore not
found: check that first.
.Sp
example: scanning through a folder for a message
.Sp
.Vb 3
\& my $refs   = $msg\->get(\*(AqReferences\*(Aq) or return;
\& my @msgids = $ref =~ m/\e<([^>]+\e>/g;
\& my @failed = $folder\->scanForMessages($msg, \e@msgids, \*(Aq3 days\*(Aq, 50);
.Ve
.SS "Sub-folders"
.IX Subsection "Sub-folders"
.ie n .IP "$obj\->\fBlistSubFolders\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBlistSubFolders\fR(%options)" 4
.IX Item "$obj->listSubFolders(%options)"
.PD 0
.IP "Mail::Box\->\fBlistSubFolders\fR(%options)" 4
.IX Item "Mail::Box->listSubFolders(%options)"
.PD
List the names of all sub-folders to this folder, not recursively
decending.  Use these names as argument to \fIopenSubFolder()\fR, to get
access to that folder.
.Sp
For \s-1MBOX\s0 folders, sub-folders are simulated.
.Sp
.Vb 5
\& \-Option    \-\-Default
\&  check       <false>
\&  folder      <from calling object>
\&  folderdir   <from folder>
\&  skip_empty  <false>
.Ve
.RS 4
.IP "check => \s-1BOOLEAN\s0" 2
.IX Item "check => BOOLEAN"
Should all returned foldernames be checked to be sure that they are of
the right type?  Each sub-folder may need to be opened to check this,
with a folder type dependent penalty (in some cases very expensive).
.IP "folder => \s-1FOLDERNAME\s0" 2
.IX Item "folder => FOLDERNAME"
The folder whose sub-folders should be listed.
.IP "folderdir => \s-1DIRECTORY\s0" 2
.IX Item "folderdir => DIRECTORY"
.PD 0
.IP "skip_empty => \s-1BOOL\s0" 2
.IX Item "skip_empty => BOOL"
.PD
Shall empty folders (folders which currently do not contain any messages)
be included?  Empty folders are not useful to open, but may be useful
to save to.
.RE
.RS 4
.Sp
example:
.Sp
.Vb 2
\& my $folder = $mgr\->open(\*(Aq=in/new\*(Aq);
\& my @subs = $folder\->listSubFolders;
\&
\& my @subs = Mail::Box::Mbox\->listSubFolders(folder => \*(Aq=in/new\*(Aq);
\& my @subs = Mail::Box::Mbox\->listSubFolders; # toplevel folders.
.Ve
.RE
.ie n .IP "$obj\->\fBnameOfSubFolder\fR( $subname, [$parentname] )" 4
.el .IP "\f(CW$obj\fR\->\fBnameOfSubFolder\fR( \f(CW$subname\fR, [$parentname] )" 4
.IX Item "$obj->nameOfSubFolder( $subname, [$parentname] )"
.PD 0
.ie n .IP "Mail::Box\->\fBnameOfSubFolder\fR( $subname, [$parentname] )" 4
.el .IP "Mail::Box\->\fBnameOfSubFolder\fR( \f(CW$subname\fR, [$parentname] )" 4
.IX Item "Mail::Box->nameOfSubFolder( $subname, [$parentname] )"
.PD
Returns the constructed name of the folder with \s-1NAME\s0, which is a
sub-folder of this current one.  You have either to call this method
as instance method, or specify a \f(CW$parentname\fR.
.Sp
example: how to get the name of a subfolder
.Sp
.Vb 2
\& my $sub = Mail::Box::Mbox\->nameOfSubfolder(\*(Aqxyz\*(Aq, \*(Aqabc\*(Aq);
\& print $sub;                        # abc/xyz
\&
\& my $f = Mail::Box::Mbox\->new(folder => \*(Aqabc\*(Aq);
\& print $f\->nameOfSubfolder(\*(Aqxyz\*(Aq);  # abc/xyz
\&
\& my $sub = Mail::Box::Mbox\->nameOfSubfolder(\*(Aqxyz\*(Aq, undef);
\& print $sub;                        # xyz
.Ve
.ie n .IP "$obj\->\fBopenRelatedFolder\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBopenRelatedFolder\fR(%options)" 4
.IX Item "$obj->openRelatedFolder(%options)"
Open a folder (usually a sub-folder) with the same options as this one.
If there is a folder manager in use, it will be informed about this new
folder.  \f(CW%options\fR overrule the options which where used for the folder
this method is called upon.
.ie n .IP "$obj\->\fBopenSubFolder\fR($subname, %options)" 4
.el .IP "\f(CW$obj\fR\->\fBopenSubFolder\fR($subname, \f(CW%options\fR)" 4
.IX Item "$obj->openSubFolder($subname, %options)"
Open (or create, if it does not exist yet) a new subfolder in an
existing folder.
.Sp
example:
.Sp
.Vb 2
\& my $folder = Mail::Box::Mbox\->new(folder => \*(Aq=Inbox\*(Aq);
\& my $sub    = $folder\->openSubFolder(\*(Aqread\*(Aq);
.Ve
.ie n .IP "$obj\->\fBtopFolderWithMessages\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBtopFolderWithMessages\fR()" 4
.IX Item "$obj->topFolderWithMessages()"
.PD 0
.IP "Mail::Box\->\fBtopFolderWithMessages\fR()" 4
.IX Item "Mail::Box->topFolderWithMessages()"
.PD
Some folder types can have messages in the top-level folder, some other
can't.
.SS "Internals"
.IX Subsection "Internals"
.ie n .IP "$obj\->\fBcoerce\fR($message, %options)" 4
.el .IP "\f(CW$obj\fR\->\fBcoerce\fR($message, \f(CW%options\fR)" 4
.IX Item "$obj->coerce($message, %options)"
Coerce the \f(CW$message\fR to be of the correct type to be placed in the
folder.  You can specify Mail::Internet and MIME::Entity objects
here: they will be translated into Mail::Message messages first.
.ie n .IP "$obj\->\fBcreate\fR($foldername, %options)" 4
.el .IP "\f(CW$obj\fR\->\fBcreate\fR($foldername, \f(CW%options\fR)" 4
.IX Item "$obj->create($foldername, %options)"
.PD 0
.ie n .IP "Mail::Box\->\fBcreate\fR($foldername, %options)" 4
.el .IP "Mail::Box\->\fBcreate\fR($foldername, \f(CW%options\fR)" 4
.IX Item "Mail::Box->create($foldername, %options)"
.PD
Create a folder.  If the folder already exists, it will be left unchanged.
The folder is created, but not opened!  If you want to open a file which
may need to be created, then use \fIMail::Box::Manager::open()\fR with the
create flag, or Mail::Box::new(create).
.Sp
.Vb 2
\& \-Option   \-\-Default
\&  folderdir  undef
.Ve
.RS 4
.IP "folderdir => \s-1DIRECTORY\s0" 2
.IX Item "folderdir => DIRECTORY"
When the foldername is preceded by a \f(CW\*(C`=\*(C'\fR, the \f(CW\*(C`folderdir\*(C'\fR directory
will be searched for the named folder.
.RE
.RS 4
.RE
.ie n .IP "$obj\->\fBdetermineBodyType\fR($message, $head)" 4
.el .IP "\f(CW$obj\fR\->\fBdetermineBodyType\fR($message, \f(CW$head\fR)" 4
.IX Item "$obj->determineBodyType($message, $head)"
Determine which kind of body will be created for this message when
reading the folder initially.
.ie n .IP "Mail::Box\->\fBfoundIn\fR( [$foldername], %options )" 4
.el .IP "Mail::Box\->\fBfoundIn\fR( [$foldername], \f(CW%options\fR )" 4
.IX Item "Mail::Box->foundIn( [$foldername], %options )"
Determine if the specified folder is of the type handled by the
folder class. This method is extended by each folder sub-type.
.Sp
The \f(CW$foldername\fR specifies the name of the folder, as is specified by the
application.  You need to specified the \f(CW\*(C`folder\*(C'\fR option when you skip
this first argument.
.Sp
\&\f(CW%options\fR is a list of extra information for the request.  Read
the documentation for each type of folder for type specific options, but
each folder class will at least support the \f(CW\*(C`folderdir\*(C'\fR option:
.Sp
.Vb 2
\& \-Option   \-\-Default
\&  folderdir  undef
.Ve
.RS 4
.IP "folderdir => \s-1DIRECTORY\s0" 2
.IX Item "folderdir => DIRECTORY"
The location where the folders of this class are stored by default.  If the
user specifies a name starting with a \f(CW\*(C`=\*(C'\fR, that indicates that the folder is
to be found in this default \s-1DIRECTORY\s0.
.RE
.RS 4
.Sp
example:
.Sp
.Vb 3
\& Mail::Box::Mbox\->foundIn(\*(Aq=markov\*(Aq,
\&     folderdir => "$ENV{HOME}/Mail");
\& Mail::Box::MH\->foundIn(folder => \*(Aq=markov\*(Aq);
.Ve
.RE
.ie n .IP "$obj\->\fBlineSeparator\fR( [<STRING|'\s-1CR\s0'|'\s-1LF\s0'|'\s-1CRLF\s0'>] )" 4
.el .IP "\f(CW$obj\fR\->\fBlineSeparator\fR( [<STRING|'\s-1CR\s0'|'\s-1LF\s0'|'\s-1CRLF\s0'>] )" 4
.IX Item "$obj->lineSeparator( [<STRING|'CR'|'LF'|'CRLF'>] )"
Returns the character or characters used to separate lines in the folder
file, optionally after setting it to \s-1STRING\s0, or one of the constants.
The first line of the folder sets the default.
.Sp
\&\s-1UNIX\s0 uses a \s-1LF\s0 character, Mac a \s-1CR\s0, and Windows both a \s-1CR\s0 and a \s-1LF\s0.  Each
separator will be represented by a \*(L"\en\*(R" within your program.  However,
when processing platform foreign folders, complications appear.  Think about
the \f(CW\*(C`Size\*(C'\fR field in the header.
.Sp
When the separator is changed, the whole folder me be rewritten.  Although,
that may not be required.
.ie n .IP "$obj\->\fBlocker\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBlocker\fR()" 4
.IX Item "$obj->locker()"
Returns the locking object.
.ie n .IP "$obj\->\fBread\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBread\fR(%options)" 4
.IX Item "$obj->read(%options)"
Read messages from the folder into memory.  The \f(CW%options\fR are folder
specific.  Do not call \f(CW\*(C`read()\*(C'\fR yourself: it will be called for you
when you open the folder via the manager or instantiate a folder
object directly.
.Sp
\&\s-1NOTE:\s0 if you are copying messages from one folder to another, use
\&\fIaddMessages()\fR instead of \f(CW\*(C`read()\*(C'\fR.
.Sp
example:
.Sp
.Vb 3
\& my $mgr = Mail::Box::Manager\->new;
\& my $folder = $mgr\->open(\*(AqInBox\*(Aq);             # implies read
\& my $folder = Mail::Box::Mbox\->new(folder => \*(AqInbox\*(Aq); # same
.Ve
.ie n .IP "$obj\->\fBreadMessages\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBreadMessages\fR(%options)" 4
.IX Item "$obj->readMessages(%options)"
Called by \fIread()\fR to actually read the messages from one specific
folder type.  The \fIread()\fR organizes the general activities.
.Sp
The \f(CW%options\fR are \f(CW\*(C`trusted\*(C'\fR, \f(CW\*(C`head_type\*(C'\fR, \f(CW\*(C`field_type\*(C'\fR,
\&\f(CW\*(C`message_type\*(C'\fR, \f(CW\*(C`body_delayed_type\*(C'\fR, and \f(CW\*(C`head_delayed_type\*(C'\fR as
defined by the folder at hand.  The defaults are the constructor
defaults (see \fInew()\fR).
.ie n .IP "$obj\->\fBstoreMessage\fR($message)" 4
.el .IP "\f(CW$obj\fR\->\fBstoreMessage\fR($message)" 4
.IX Item "$obj->storeMessage($message)"
Store the message in the folder without the checks as performed by
\&\fIaddMessage()\fR.
.ie n .IP "$obj\->\fBtoBeThreaded\fR($messages)" 4
.el .IP "\f(CW$obj\fR\->\fBtoBeThreaded\fR($messages)" 4
.IX Item "$obj->toBeThreaded($messages)"
The specified message is ready to be removed from a thread.
This will be passed on to the mail-manager, which keeps an overview on
which thread-detection objects are floating around.
.ie n .IP "$obj\->\fBtoBeUnthreaded\fR($messages)" 4
.el .IP "\f(CW$obj\fR\->\fBtoBeUnthreaded\fR($messages)" 4
.IX Item "$obj->toBeUnthreaded($messages)"
The specified message is ready to be included in a thread.
This will be passed on to the mail-manager, which keeps an overview on
which thread-detection objects are floating around.
.ie n .IP "$obj\->\fBupdateMessages\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBupdateMessages\fR(%options)" 4
.IX Item "$obj->updateMessages(%options)"
Called by \fIupdate()\fR to read messages which arrived in the folder
after it was opened.  Sometimes, external applications dump messages
in a folder without locking (or using a different lock than your
application does).
.Sp
Although this is quite a dangerous, it only fails when a folder is
updated (reordered or message removed) at exactly the same time as
new messages arrive.  These collisions are sparse.
.Sp
The options are the same as for \fIreadMessages()\fR.
.ie n .IP "$obj\->\fBwrite\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBwrite\fR(%options)" 4
.IX Item "$obj->write(%options)"
Write the data to disk.  The folder (a \f(CW\*(C`true\*(C'\fR value) is returned if
successful.  Deleted messages are transformed into destroyed messages:
their memory is freed.
.Sp
\&\s-1WARNING:\s0 When moving messages from one folder to another, be sure to
write (or \fIclose()\fR) the destination folder before writing (or closing)
the source folder: otherwise you may lose data if the system crashes or
if there are software problems.
.Sp
To write a folder to a different file, you must first create a new folder,
then move all the messages, and then write or \fIclose()\fR that new folder.
.Sp
.Vb 3
\& \-Option      \-\-Default
\&  force         <false>
\&  save_deleted  <false>
.Ve
.RS 4
.IP "force => \s-1BOOLEAN\s0" 2
.IX Item "force => BOOLEAN"
Override write-protection with new(access) while opening the folder
(whenever possible, it may still be blocked by the operating system).
.IP "save_deleted => \s-1BOOLEAN\s0" 2
.IX Item "save_deleted => BOOLEAN"
Do also write messages which where flagged to be deleted to their folder.  The
flag for deletion is conserved (when possible), which means that a re-open of
the folder may remove the messages for real.  See close(save_deleted).
.RE
.RS 4
.RE
.ie n .IP "$obj\->\fBwriteMessages\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBwriteMessages\fR(%options)" 4
.IX Item "$obj->writeMessages(%options)"
Called by \fIwrite()\fR to actually write the messages from one specific
folder type.  The \f(CW\*(C`write\*(C'\fR organizes the general activities.  All options
to \fIwrite()\fR are passed to \f(CW\*(C`writeMessages\*(C'\fR as well.  Besides, a few extra
are added by \f(CW\*(C`write\*(C'\fR itself.
.Sp
.Vb 2
\& \-Option  \-\-Default
\&  messages  <required>
.Ve
.RS 4
.IP "messages => \s-1ARRAY\s0" 2
.IX Item "messages => ARRAY"
The messages to be written, which is a sub-set of all messages in the
current folder.
.RE
.RS 4
.RE
.SS "Other methods"
.IX Subsection "Other methods"
.ie n .IP "$obj\->\fBtimespan2seconds\fR($time)" 4
.el .IP "\f(CW$obj\fR\->\fBtimespan2seconds\fR($time)" 4
.IX Item "$obj->timespan2seconds($time)"
.PD 0
.IP "Mail::Box\->\fBtimespan2seconds\fR($time)" 4
.IX Item "Mail::Box->timespan2seconds($time)"
.PD
\&\f(CW$time\fR is a string, which starts with a float, and then one of the
words 'hour', 'hours', 'day', 'days', 'week', or 'weeks'.  For instance:
\&'1 hour' or '4 weeks'.
.SS "Error handling"
.IX Subsection "Error handling"
Extends \*(L"Error handling\*(R" in Mail::Reporter.
.ie n .IP "$obj\->\fB\s-1AUTOLOAD\s0\fR()" 4
.el .IP "\f(CW$obj\fR\->\fB\s-1AUTOLOAD\s0\fR()" 4
.IX Item "$obj->AUTOLOAD()"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBaddReport\fR($object)" 4
.el .IP "\f(CW$obj\fR\->\fBaddReport\fR($object)" 4
.IX Item "$obj->addReport($object)"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBdefaultTrace\fR( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )" 4
.el .IP "\f(CW$obj\fR\->\fBdefaultTrace\fR( [$level]|[$loglevel, \f(CW$tracelevel\fR]|[$level, \f(CW$callback\fR] )" 4
.IX Item "$obj->defaultTrace( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )"
.PD 0
.ie n .IP "Mail::Box\->\fBdefaultTrace\fR( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )" 4
.el .IP "Mail::Box\->\fBdefaultTrace\fR( [$level]|[$loglevel, \f(CW$tracelevel\fR]|[$level, \f(CW$callback\fR] )" 4
.IX Item "Mail::Box->defaultTrace( [$level]|[$loglevel, $tracelevel]|[$level, $callback] )"
.PD
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBerrors\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBerrors\fR()" 4
.IX Item "$obj->errors()"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBlog\fR( [$level, [$strings]] )" 4
.el .IP "\f(CW$obj\fR\->\fBlog\fR( [$level, [$strings]] )" 4
.IX Item "$obj->log( [$level, [$strings]] )"
.PD 0
.IP "Mail::Box\->\fBlog\fR( [$level, [$strings]] )" 4
.IX Item "Mail::Box->log( [$level, [$strings]] )"
.PD
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBlogPriority\fR($level)" 4
.el .IP "\f(CW$obj\fR\->\fBlogPriority\fR($level)" 4
.IX Item "$obj->logPriority($level)"
.PD 0
.IP "Mail::Box\->\fBlogPriority\fR($level)" 4
.IX Item "Mail::Box->logPriority($level)"
.PD
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBlogSettings\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBlogSettings\fR()" 4
.IX Item "$obj->logSettings()"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBnotImplemented\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBnotImplemented\fR()" 4
.IX Item "$obj->notImplemented()"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBreport\fR( [$level] )" 4
.el .IP "\f(CW$obj\fR\->\fBreport\fR( [$level] )" 4
.IX Item "$obj->report( [$level] )"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBreportAll\fR( [$level] )" 4
.el .IP "\f(CW$obj\fR\->\fBreportAll\fR( [$level] )" 4
.IX Item "$obj->reportAll( [$level] )"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBtrace\fR( [$level] )" 4
.el .IP "\f(CW$obj\fR\->\fBtrace\fR( [$level] )" 4
.IX Item "$obj->trace( [$level] )"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.ie n .IP "$obj\->\fBwarnings\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBwarnings\fR()" 4
.IX Item "$obj->warnings()"
Inherited, see \*(L"Error handling\*(R" in Mail::Reporter
.SS "Cleanup"
.IX Subsection "Cleanup"
Extends \*(L"Cleanup\*(R" in Mail::Reporter.
.ie n .IP "$obj\->\fB\s-1DESTROY\s0\fR()" 4
.el .IP "\f(CW$obj\fR\->\fB\s-1DESTROY\s0\fR()" 4
.IX Item "$obj->DESTROY()"
This method is called by Perl when an folder-object is no longer accessible
by the rest of the program.
.SH "DETAILS"
.IX Header "DETAILS"
.SS "Different kinds of folders"
.IX Subsection "Different kinds of folders"
In general, there are three classes of folders: those who group messages
per file, those who group messages in a directory, and those do not
provide direct access to the message data.  These folder types are
each based on a different base class.
.IP "\(bu" 4
File based folders Mail::Box::File
.Sp
File based folders maintain a folder (a set of messages) in one
single file.  The advantage is that your folder has only one
single file to access, which speeds-up things when all messages
must be accessed at once.
.Sp
One of the main disadvantages over directory based folders
is that you have to construct some means to keep all message apart.
For instance \s-1MBOX\s0 adds a message separator line between the messages
in the file, and this line can cause confusion with the message's
contents.
.Sp
Where access to all messages at once is faster in file based folders,
access to a single message is (much) slower, because the whole folder
must be read.  However, in directory based folders you have to figure-out
which message you need, which may be a hassle as well.
.Sp
Examples of file based folders are \s-1MBOX\s0, \s-1DBX\s0, and NetScape.
.IP "\(bu" 4
Directory based folders Mail::Box::Dir
.Sp
In stead of collecting multiple messages in one file, you can also
put each message in a separate file and collect those files in a
directory to represent a folder.
.Sp
The main disadvantages of these folders are the enormous amount of
tiny files you usually get in your file-system.  It is extremely
slow to search through your whole folder, because many files have
to be opened to do so.
.Sp
The best feature of this organization is that each message is kept
exactly as it was received, and can be processed with external scripts
as well: you do not need any mail user agent (\s-1MUA\s0).
.Sp
Examples of directoy organized folders are \s-1MH\s0, Maildir, \s-1EMH\s0, and \s-1XMH\s0.
.IP "\(bu" 4
Network (external) folders Mail::Box::Net
.Sp
Where both types described before provide direct access to the
message data, maintain these folder types the message data for you:
you have to request for messages or parts of them.  These folders
do not have a filename, file-system privileges and system locking
to worry about, but typically require a hostname, folder and message
IDs, and authorization.
.Sp
Examples of these folder types are the popular \s-1POP\s0 and \s-1IMAP\s0, and
database oriented message storage.
.SS "Available folder types"
.IX Subsection "Available folder types"
.IP "\(bu" 4
Mail::Box::Dbx (read only)
.Sp
Dbx files are created by Outlook Express. Using the external (optional)
Mail::Transport::Dbx module, you can read these folders, even
when you are running MailBox on a UNIX/Linux platform.
.Sp
Writing and deleting messages is not supported by the library, and
therefore not by MailBox. Read access is enough to do folder conversions,
for instance.
.IP "\(bu" 4
Mail::Box::IMAP4 (partially)
.Sp
The \s-1IMAP\s0 protocol is very complex.  Some parts are implemented to
create (sub-optimal but usable) \s-1IMAP\s0 clients.  Besides, there are
also some parts for \s-1IMAP\s0 servers present.  The most important lacking
feature is support for encrypted connections.
.IP "\(bu" 4
Mail::Box::Maildir
.Sp
Maildir folders have a directory for each folder.  A folder directory
contains \f(CW\*(C`tmp\*(C'\fR, \f(CW\*(C`new\*(C'\fR, and \f(CW\*(C`cur\*(C'\fR sub-directories, each containting
messages with a different purpose.  Files with new messages are created
in \f(CW\*(C`tmp\*(C'\fR, then moved to \f(CW\*(C`new\*(C'\fR (ready to be accepted).  Later, they are
moved to the \f(CW\*(C`cur\*(C'\fR directory (accepted).  Each message is one file with
a name starting with timestamp.  The name also contains flags about the
status of the message.
.Sp
Maildir folders can not be used on Windows by reason of file-name
limitations on that platform.
.IP "\(bu" 4
Mail::Box::Mbox
.Sp
A folder type in which all related messages are stored in one file.  This
is a very common folder type for \s-1UNIX\s0.
.IP "\(bu" 4
Mail::Box::MH
.Sp
This folder creates a directory for each folder, and a message is one
file inside that directory.  The message files are numbered sequentially
on order of arrival.  A special \f(CW\*(C`.mh_sequences\*(C'\fR file maintains flags
about the messages.
.IP "\(bu" 4
Mail::Box::POP3 (read/delete only)
.Sp
\&\s-1POP3\s0 is a protocol which can be used to retrieve messages from a
remote system.  After the connection to a \s-1POP\s0 server is made, the
messages can be looked at and removed as if they are on the local
system.
.IP "\(bu" 4
Mail::Box::Netzwert
.Sp
The Netzwert folder type is optimized for mailbox handling on a cluster
of systems with a shared \s-1NFS\s0 storage.  The code is not released under
\&\s-1GPL\s0 (yet)
.PP
Other folder types are on the (long) wishlist to get implemented.  Please,
help implementing more of them.
.SS "Folder class implementation"
.IX Subsection "Folder class implementation"
The class structure of folders is very close to that of messages.  For
instance, a Mail::Box::File::Message relates to a Mail::Box::File
folder.  The folder types are:
.PP
.Vb 10
\&                    Mail::Box::Netzwert
\& Mail::Box::Mbox   | Mail::Box::Maildir Mail::Box::POP3
\& |  Mail::Box::Dbx | | Mail::Box::MH    |  Mail::Box::IMAP4
\& |  |               | | |                 |  |
\& |  |               | | |                 |  |
\& Mail::Box::File   Mail::Box::Dir       Mail::Box::Net
\&       |                  |                   |
\&       \`\-\-\-\-\-\-\-\-\-\-\-\-\-\-.   |   .\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\*(Aq
\&                      |   |   |
\&                      Mail::Box
\&                          |
\&                          |
\&                    Mail::Reporter (general base class)
.Ve
.PP
By far most folder features are implemented in Mail::Box, so
available to all folder types.  Sometimes, features which appear
in only some of the folder types are simulated for folders that miss
them, like sub-folder support for \s-1MBOX\s0.
.SH "DIAGNOSTICS"
.IX Header "DIAGNOSTICS"
.ie n .IP "Warning: Changes not written to read-only folder $self." 4
.el .IP "Warning: Changes not written to read-only folder \f(CW$self\fR." 4
.IX Item "Warning: Changes not written to read-only folder $self."
You have opened the folder read-only \-\-which is the default set
by new(access)\-\-, made modifications, and now want to close it.
Set close(force) if you want to overrule the access mode, or close
the folder with close(write) set to \f(CW\*(C`NEVER\*(C'\fR.
.IP "Error: Copying failed for one message." 4
.IX Item "Error: Copying failed for one message."
For some reason, for instance disc full, removed by external process, or
read-protection, it is impossible to copy one of the messages.  Copying will
proceed for the other messages.
.ie n .IP "Error: Destination folder $name is not writable." 4
.el .IP "Error: Destination folder \f(CW$name\fR is not writable." 4
.IX Item "Error: Destination folder $name is not writable."
The folder where the messages are copied to is not opened with write
access (see new(access)).  This has no relation with write permission
to the folder which is controled by your operating system.
.ie n .IP "Warning: Different messages with id $msgid" 4
.el .IP "Warning: Different messages with id \f(CW$msgid\fR" 4
.IX Item "Warning: Different messages with id $msgid"
The message id is discovered more than once within the same folder, but the
content of the message seems to be different.  This should not be possible:
each message must be unique.
.ie n .IP "Error: Folder $name is opened read-only" 4
.el .IP "Error: Folder \f(CW$name\fR is opened read-only" 4
.IX Item "Error: Folder $name is opened read-only"
You can not write to this folder unless you have opened the folder to
write or append with new(access), or the \f(CW\*(C`force\*(C'\fR option is set true.
.ie n .IP "Error: Folder $name not deleted: not writable." 4
.el .IP "Error: Folder \f(CW$name\fR not deleted: not writable." 4
.IX Item "Error: Folder $name not deleted: not writable."
The folder must be opened with write access via new(access), otherwise
removing it will be refused.  So, you may have write-access according to
the operating system, but that will not automatically mean that this
\&\f(CW\*(C`delete\*(C'\fR method permits you to.  The reverse remark is valid as well.
.IP "Error: Invalid timespan '$timespan' specified." 4
.IX Item "Error: Invalid timespan '$timespan' specified."
The string does not follow the strict rules of the time span syntax which
is permitted as parameter.
.IP "Warning: Message-id '$msgid' does not contain a domain." 4
.IX Item "Warning: Message-id '$msgid' does not contain a domain."
According to the RFCs, message-ids need to contain a unique random part,
then an \f(CW\*(C`@\*(C'\fR, and then a domain name.  This is made to avoid the creation
of two messages with the same id.  The warning emerges when the \f(CW\*(C`@\*(C'\fR is
missing from the string.
.IP "Error: No folder name specified." 4
.IX Item "Error: No folder name specified."
You did not specify the name of a folder to be opened.  Use the
new(folder) option or set the \f(CW\*(C`MAIL\*(C'\fR environment variable.
.ie n .IP "Error: Package $package does not implement $method." 4
.el .IP "Error: Package \f(CW$package\fR does not implement \f(CW$method\fR." 4
.IX Item "Error: Package $package does not implement $method."
Fatal error: the specific package (or one of its superclasses) does not
implement this method where it should. This message means that some other
related classes do implement this method however the class at hand does
not.  Probably you should investigate this and probably inform the author
of the package.
.ie n .IP "Error: Unable to create subfolder $name of $folder." 4
.el .IP "Error: Unable to create subfolder \f(CW$name\fR of \f(CW$folder\fR." 4
.IX Item "Error: Unable to create subfolder $name of $folder."
The copy includes the subfolders, but for some reason it was not possible
to copy one of these.  Copying will proceed for all other sub-folders.
.ie n .IP "Error: Writing folder $name failed" 4
.el .IP "Error: Writing folder \f(CW$name\fR failed" 4
.IX Item "Error: Writing folder $name failed"
For some reason (you probably got more error messages about this problem)
it is impossible to write the folder, although you should because there
were changes made.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
This module is part of Mail-Box distribution version 2.117,
built on August 24, 2014. Website: \fIhttp://perl.overmeer.net/mailbox/\fR
.SH "LICENSE"
.IX Header "LICENSE"
Copyrights 2001\-2014 by [Mark Overmeer]. For other contributors see ChangeLog.
.PP
This program is free software; you can redistribute it and/or modify it
under the same terms as Perl itself.
See \fIhttp://www.perl.com/perl/misc/Artistic.html\fR
