.\" Automatically generated by Pod::Man 4.14 (Pod::Simple 3.40)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\" ========================================================================
.\"
.IX Title "Mail::Message::Construct::Forward 3"
.TH Mail::Message::Construct::Forward 3 "2020-02-07" "perl v5.32.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
Mail::Message::Construct::Forward \- forwarding a Mail::Message
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
.Vb 2
\& my Mail::Message $forward = $message\->forward(To => \*(Aqyou\*(Aq);
\& $forward\->send;
.Ve
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
Complex functionality on Mail::Message objects is implemented in
different files which are autoloaded.  This file implements the
functionality related to creating forwarded messages.
.SH "METHODS"
.IX Header "METHODS"
.SS "Constructing a message"
.IX Subsection "Constructing a message"
.ie n .IP "$obj\->\fBforward\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBforward\fR(%options)" 4
.IX Item "$obj->forward(%options)"
Forward the content of this message.  The body of the message to be forwarded
is encapsulated in some accompanying text (if you have no wish for that, than
\&\f(CW\*(C`bounce\*(C'\fR is your choice).  A Mail::Message object is returned on success.
.Sp
You may forward a whole message, but also message parts.
You may wish to overrule some of the default header settings for the
reply immediately, or you may do that later with \f(CW\*(C`set\*(C'\fR on the header.
.Sp
When a multi-part body is encountered, and the message is included to
\&\s-1ATTACH,\s0 the parts which look like signatures will be removed.  If only
one message remains, it will be the added as single attachment, otherwise
a nested multipart will be the result.  The value of this option does not
matter, as long as it is present.  See \f(CW\*(C`Mail::Message::Body::Multipart\*(C'\fR.
.Sp
.Vb 12
\& \-Option    \-\-Default
\&  Bcc         undef
\&  Cc          undef
\&  Date        <now>
\&  From        <\*(Aqto\*(Aq in current>
\&  Message\-ID  <uniquely generated>
\&  Subject     forwardSubject()
\&  To          <required>
\&  body        undef
\&  include     <if body then \*(AqNO\*(Aq else C<\*(AqINLINE\*(Aq>>
\&  preamble    constructed from prelude and postlude
\&  signature   undef
.Ve
.RS 4
.IP "Bcc => \s-1ADDRESSES\s0" 2
.IX Item "Bcc => ADDRESSES"
Receivers of blind carbon copies: their names will not be published to
other message receivers.
.IP "Cc => \s-1ADDRESSES\s0" 2
.IX Item "Cc => ADDRESSES"
The carbon-copy receivers, by default none.
.IP "Date => \s-1DATE\s0" 2
.IX Item "Date => DATE"
The date to be used in the message sent.
.IP "From => \s-1ADDRESSES\s0" 2
.IX Item "From => ADDRESSES"
Your identification, by default taken from the \f(CW\*(C`To\*(C'\fR field of the
source message.
.IP "Message-ID => \s-1STRING\s0" 2
.IX Item "Message-ID => STRING"
Supply a \s-1STRING\s0 as specific message-id for the forwarded message.
By default, one is generated for you.  If there are no angles around
your id, they will be added.
.IP "Subject => STRING|CODE" 2
.IX Item "Subject => STRING|CODE"
Force the subject line to the specific \s-1STRING,\s0 or the result of the
subroutine specified by \s-1CODE.\s0  The subroutine will be called passing
the subject of the original message as only argument.  By default,
the \fBforwardSubject()\fR method is used.
.IP "To => \s-1ADDRESSES\s0" 2
.IX Item "To => ADDRESSES"
The destination of your message. Obligatory.  The \s-1ADDRESSES\s0 may be
specified as string, a Mail::Address object, or as array of
Mail::Address objects.
.IP "body => \s-1OBJECT\s0" 2
.IX Item "body => OBJECT"
If you specify a fully prepared body \s-1OBJECT,\s0 it will be used as forwarded
message contents.  In this case, only the headers are constructed for you.
.IP "include => '\s-1NO\s0'|'\s-1INLINE\s0'|'\s-1ATTACH\s0'|'\s-1ENCAPSULATE\s0'" 2
.IX Item "include => 'NO'|'INLINE'|'ATTACH'|'ENCAPSULATE'"
Must the message where this is a reply to be included in the message?
When \f(CW\*(C`INLINE\*(C'\fR is given, you may pass the options of \fBforwardInline()\fR
as well.
.Sp
In many applications, the forward option \f(CW\*(C`as attachment\*(C'\fR results in a
structure which is produced when this option is set to \f(CW\*(C`ENCAPSULATE\*(C'\fR.
Their default behavior is usually \f(CW\*(C`INLINE\*(C'\fR.
.Sp
It is only possible to inline textual messages, therefore binary or
multi-part messages will always be enclosed as attachment.
Read the details in section \*(L"Creating a forward\*(R"..
.IP "preamble => STRING|BODY" 2
.IX Item "preamble => STRING|BODY"
Part which is attached before the forwarded message.  If no preamble
is given, then it is constructed from the prelude and postlude.  When
these are also not present, you will still get a one liner: the result
of \fBforwardPrelude()\fR
.IP "signature => BODY|MESSAGE" 2
.IX Item "signature => BODY|MESSAGE"
The signature to be added in case of a multi-part forward.  The mime-type
of the signature body should indicate this is a used as such.  However,
in \s-1INLINE\s0 mode, the body will be taken, a line containing \f(CW\*(Aq\-\- \*(Aq\fR added
before it, and added behind the epilogue.
.RE
.RS 4
.RE
.ie n .IP "$obj\->\fBforwardAttach\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBforwardAttach\fR(%options)" 4
.IX Item "$obj->forwardAttach(%options)"
Forward the message as \fIflat\fR attachment to the specified \f(CW\*(C`preamble\*(C'\fR.  You
can specify all options available to \f(CW\*(C`forward()\*(C'\fR, although a \f(CW\*(C`preamble\*(C'\fR
which is provided as body object is required, and any specified \f(CW\*(C`body\*(C'\fR
is ignored.
.Sp
.Vb 2
\& \-Option  \-\-Default
\&  preamble  <required>
.Ve
.RS 4
.IP "preamble => BODY|PART" 2
.IX Item "preamble => BODY|PART"
.RE
.RS 4
.RE
.PD 0
.ie n .IP "$obj\->\fBforwardEncapsulate\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBforwardEncapsulate\fR(%options)" 4
.IX Item "$obj->forwardEncapsulate(%options)"
.PD
Like \fBforwardAttach()\fR, but in this case the original message is first
encapsulated as nested message in a Mail::Message::Body::Nested, and
then joint into a multipart.
.Sp
You can specify all options available to \f(CW\*(C`forward()\*(C'\fR, although a \f(CW\*(C`preamble\*(C'\fR
which is provided as body object is required, and any specified \f(CW\*(C`body\*(C'\fR
is ignored.  Signatures are not stripped.  Signatures are not stripped.
.Sp
.Vb 2
\& \-Option  \-\-Default
\&  preamble  <required>
.Ve
.RS 4
.IP "preamble => BODY|PART" 2
.IX Item "preamble => BODY|PART"
.RE
.RS 4
.RE
.PD 0
.ie n .IP "$obj\->\fBforwardInline\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBforwardInline\fR(%options)" 4
.IX Item "$obj->forwardInline(%options)"
.PD
This method is equivalent in behavior to \fBforward()\fR with the
option \f(CW\*(C`include\*(C'\fR set to \f(CW\*(AqINLINE\*(Aq\fR.  You can specify most of
the fields which are available to \fBforward()\fR except
\&\f(CW\*(C`include\*(C'\fR and \f(CW\*(C`body\*(C'\fR.
.Sp
.Vb 7
\& \-Option         \-\-Default
\&  is_attached      "[The forwarded message is attached]\en"
\&  max_signature    10
\&  postlude         undef
\&  prelude          undef
\&  quote            undef
\&  strip_signature  qr/^\-\-\es/
.Ve
.RS 4
.IP "is_attached => \s-1STRING\s0" 2
.IX Item "is_attached => STRING"
A forward on binary messages can not be inlined.  Therefore, they are
automatically translated into an attachment, as made by \fBforwardAttach()\fR.
The obligatory preamble option to that method may be specified as option
to this method, to be used in case of such a forward of a binary, but
is otherwise constructed from the prelude, the value of this option, and
the postlude.
.IP "max_signature => \s-1INTEGER\s0" 2
.IX Item "max_signature => INTEGER"
Passed to Mail::Message::Body::stripSignature(max_lines).  Only
effective for single-part messages.
.IP "postlude => \s-1BODY\s0" 2
.IX Item "postlude => BODY"
The line(s) which to be added after the quoted reply lines.  Create a
body for it first.  This should not include the signature, which has its
own option.  The signature will be added after the postlude when the
forwarded message is \f(CW\*(C`INLINE\*(C'\fRd.
.IP "prelude => \s-1BODY\s0" 2
.IX Item "prelude => BODY"
The line(s) which will be added before the quoted forwarded lines.
If nothing is specified, the result of the \fBforwardPrelude()\fR method
is used.  When \f(CW\*(C`undef\*(C'\fR is specified, no prelude will be added.
.IP "quote => CODE|STRING" 2
.IX Item "quote => CODE|STRING"
Mangle the lines of an \f(CW\*(C`INLINE\*(C'\fRd reply with \s-1CODE,\s0 or by prepending a
\&\s-1STRING\s0 to each line.  The routine specified by \s-1CODE\s0 is called when the
line is in \f(CW$_\fR.
.Sp
By default, nothing is added before each line.  This option is processed
after the body has been decoded.
.IP "strip_signature => REGEXP|STRING|CODE" 2
.IX Item "strip_signature => REGEXP|STRING|CODE"
Remove the signature of the sender.  The value of this parameter is
passed to Mail::Message::Body::stripSignature(pattern), unless the
source text is not included.  The signature is stripped from the message
before quoting.
.RE
.RS 4
.RE
.ie n .IP "$obj\->\fBforwardNo\fR(%options)" 4
.el .IP "\f(CW$obj\fR\->\fBforwardNo\fR(%options)" 4
.IX Item "$obj->forwardNo(%options)"
Construct a forward, where the whole body of the message is already
constructed.  That complex body is usually produced in \fBforwardInline()\fR,
\&\fBforwardAttach()\fR, or \fBforwardEncapsulate()\fR.
.Sp
The \f(CW%options\fR are the same as for \f(CW\*(C`forward()\*(C'\fR except that \f(CW\*(C`body\*(C'\fR is
required.  Some other options, like \f(CW\*(C`preamble\*(C'\fR, are ignored.
.Sp
.Vb 2
\& \-Option\-\-Default
\&  body    <required>
.Ve
.RS 4
.IP "body => \s-1BODY\s0" 2
.IX Item "body => BODY"
.RE
.RS 4
.RE
.PD 0
.ie n .IP "$obj\->\fBforwardPostlude\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBforwardPostlude\fR()" 4
.IX Item "$obj->forwardPostlude()"
.PD
Added after the forwarded message.
.Sp
example:
.Sp
.Vb 1
\& \-\-\-\- END forwarded message
.Ve
.ie n .IP "$obj\->\fBforwardPrelude\fR()" 4
.el .IP "\f(CW$obj\fR\->\fBforwardPrelude\fR()" 4
.IX Item "$obj->forwardPrelude()"
Create a few lines to be included before the forwarded message
content.  The return is an array of lines.
.Sp
example:
.Sp
.Vb 6
\& \-\-\-\- BEGIN forwarded message
\& From: him@somewhere.else.nl (Original Sender)
\& To: me@example.com (Me the receiver)
\& Cc: the.rest@world.net
\& Date: Wed, 9 Feb 2000 15:44:05 \-0500
\& <blank line>
.Ve
.ie n .IP "$obj\->\fBforwardSubject\fR(\s-1STRING\s0)" 4
.el .IP "\f(CW$obj\fR\->\fBforwardSubject\fR(\s-1STRING\s0)" 4
.IX Item "$obj->forwardSubject(STRING)"
Create a subject for a message which is a forward from this one.  This routine
tries to count the level of reply in subject field, and transform it into
a standard form.  Please contribute improvements.
.Sp
example:
.Sp
.Vb 4
\& subject                 \-\-> Forw: subject
\& Re: subject             \-\-> Forw: Re: subject
\& Re[X]: subject          \-\-> Forw: Re[X]: subject
\& <blank>                 \-\-> Forwarded
.Ve
.SH "DETAILS"
.IX Header "DETAILS"
.SS "Creating a forward"
.IX Subsection "Creating a forward"
The main difference between \fBbounce()\fR and \fBforward()\fR is the reason
for message processing.  The \fIbounce\fR has no intention to modify the
content of message: the same information is passed-on to someplace else.
This may mean some conversions, but for instance, the Message-ID does
not need to be changed.
.PP
The purpose of \fI\f(BIforward()\fI\fR is to pass on information which is
modified: annotated or reduced.  The information is not sent back
to the author of the original message (which is implemented by \fBreply()\fR),
but to someone else.
.PP
So: some information comes in, is modified, and than forwarded to someone
else.  Currently, there are four ways to get the original information
included, which are explained in the next sections.
.PP
After the creation of the forward, you may want to \fBrebuild()\fR the
message to remove unnecessary complexities.  Of course, that is not
required.
.PP
\fIforward, specify a body\fR
.IX Subsection "forward, specify a body"
.PP
When you specify forward(body), you have created your own body object to
be used as content of the forwarded message.  This implies that
forward(include) is \f(CW\*(AqNO\*(Aq\fR: no automatic generation of the forwarded
body.
.PP
\fIforward, inline the original\fR
.IX Subsection "forward, inline the original"
.PP
The forward(include) is set to \f(CW\*(AqINLINE\*(Aq\fR (the default)
This is the most complicated situation, but most often used by MUAs:
the original message is inserted textually in the new body.  You can
set-up automatic stripping of signatures, the way of encapsulation,
and texts which should be added before and after the encapsulated part.
.PP
However, the result may not always be what you expect.  For instance,
some people use very long signatures which will not be automatically
stripped because the pass the threshold.  So, you probably need some
manual intervention after the message is created and before it is sent.
.PP
When a binary message is encountered, inlining is impossible.  In that
case, the message is treated as if \f(CW\*(AqENCAPSULATE\*(Aq\fR was requested.
.PP
\fIforward, attach the original\fR
.IX Subsection "forward, attach the original"
.PP
When forward(include) is explicitly set to \f(CW\*(AqATTACH\*(Aq\fR the result
will be a multipart which contains two parts.  The first part will
be your message, and the second the body of the original message.
.PP
This means that the headers of the forwarded message are used for
the new message, and detached from the part which now contains the
original body information.  Content related headers will (of course)
still be part of that part, but lines line \f(CW\*(C`To\*(C'\fR and \f(CW\*(C`Subject\*(C'\fR will
not be stored with that part.
.PP
As example of the structural transformation:
.PP
.Vb 4
\& # code: $original\->printStructure;
\& multipart/alternative: The source message
\&   text/plain: content in raw text
\&   text/html: content as html
\&
\& # code: $fwd = $original\->forward(include => \*(AqATTACH\*(Aq);
\& # code: $fwd\->printStructure
\& multipart/mixed: The source message
\&   text/plain: prelude/postlude/signature
\&   multipart/alternative
\&     text/plain: content in raw text
\&     text/html: content as html
.Ve
.PP
\fIforward, encapsulate the original\fR
.IX Subsection "forward, encapsulate the original"
.PP
When forward(include) is explicitly set to \f(CW\*(AqENCAPSULATE\*(Aq\fR, then
the original message is left in-tact as good as possible.  The lines
of the original message are used in the main message header but also
enclosed in the part header.
.PP
The encapsulation is implemented using a nested message, content type
\&\f(CW\*(C`message/rfc822\*(C'\fR.  As example of the structural transformation:
.PP
.Vb 4
\& # code: $original\->printStructure;
\& multipart/alternative: The source message
\&   text/plain: content in raw text
\&   text/html: content as html
\&
\& # code: $fwd = $original\->forward(include => \*(AqENCAPSULATE\*(Aq);
\& # code: $fwd\->printStructure
\& multipart/mixed: The source message
\&   text/plain: prelude/postlude/signature
\&   message/rfc822
\&      multipart/alternative: The source message
\&         text/plain: content in raw text
\&         text/html: content as html
.Ve
.PP
The message structure is much more complex, but no information is lost.
This is probably the reason why many MUAs use this when the forward
an original message as attachment.
.SH "DIAGNOSTICS"
.IX Header "DIAGNOSTICS"
.ie n .IP "Error: Cannot include forward source as $include." 4
.el .IP "Error: Cannot include forward source as \f(CW$include\fR." 4
.IX Item "Error: Cannot include forward source as $include."
Unknown alternative for the forward(include).  Valid choices are
\&\f(CW\*(C`NO\*(C'\fR, \f(CW\*(C`INLINE\*(C'\fR, \f(CW\*(C`ATTACH\*(C'\fR, and \f(CW\*(C`ENCAPSULATE\*(C'\fR.
.IP "Error: Method forwardAttach requires a preamble" 4
.IX Item "Error: Method forwardAttach requires a preamble"
.PD 0
.IP "Error: Method forwardEncapsulate requires a preamble" 4
.IX Item "Error: Method forwardEncapsulate requires a preamble"
.IP "Error: No address to create forwarded to." 4
.IX Item "Error: No address to create forwarded to."
.PD
If a forward message is created, a destination address must be specified.
.SH "SEE ALSO"
.IX Header "SEE ALSO"
This module is part of Mail-Message distribution version 3.009,
built on February 07, 2020. Website: \fIhttp://perl.overmeer.net/CPAN/\fR
.SH "LICENSE"
.IX Header "LICENSE"
Copyrights 2001\-2020 by [Mark Overmeer <markov@cpan.org>]. For other contributors see ChangeLog.
.PP
This program is free software; you can redistribute it and/or modify it
under the same terms as Perl itself.
See \fIhttp://dev.perl.org/licenses/\fR
